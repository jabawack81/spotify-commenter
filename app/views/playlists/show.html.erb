<dl class="row">
  <dt class="col-sm-2">Name:</dt>
  <dd class="col-sm-10"><%= @playlist.spotify_name %></dd>
  <dt class="col-sm-2">Description:</dt>
  <dd class="col-sm-10"><%= @playlist.spotify_description %></dd>
  <dt class="col-sm-2">Link:</dt>
  <dd class="col-sm-10"><%= link_to "Open in Spotify", @playlist.spotify_uri %></dd>
</dl>

<section class="comments">
  <div class="new-comment-container">
    <%= render "playlist_comments", comments: @playlist.comments, playlist: @playlist %>
  </div>
  <div class="comments-container">
    <%= render "new_playlist_comment", comment: @playlist.comments.create, playlist: @playlist %>
  </div>
</section>

<h3>Tracks</h3>
<dl class="row">
</dl>
<div id="accordion">
  <% @playlist.playlist_tracks.each do |playlist_track| %>
    <div class="card">
      <div class="card-header" id="heading<%= playlist_track.id %>">
        <h5 class="mb-0">
          <button class="btn btn-link" data-toggle="collapse" data-target="#collapse<%= playlist_track.id %>" aria-expanded="false" aria-controls="collapse<%= playlist_track.id %>">
            <%= playlist_track.track.spotify_name %> - <%= playlist_track.track.spotify_album_name %> by <%= playlist_track.track.spotify_artist %>
          </button>
        </h5>
      </div>
      <div id="collapse<%= playlist_track.id %>" class="collapse" aria-labelledby="heading<%= playlist_track.id %>" data-parent="#accordion">
        <div class="card-body">
          <table>
            <tr>
              <td>
                <%= image_tag playlist_track.track.medium_image_url, alt: "Album cover" %>
              </td>
              <td rowspan="2">
                <section class="comments">
                  <div class="new-comment-container">
                    <%= render "track_comments", comments: playlist_track.comments, playlist: @playlist, track: playlist_track  %>
                  </div>
                  <div class="comments-container">
                    <%= render "new_track_comment", comment: playlist_track.comments.create, playlist: @playlist, track: playlist_track %>
                  </div>
                </section>
              </td>
            </tr>
            <tr>
              <td>
                <audio controls>
                  <source src="<%= playlist_track.track.spotify_preview_url %>" type="audio/mpeg">
                  Your browser does not support the audio element.
                </audio>
              </td>
            </tr>
          </table>
        </div>
      </div>
    </div>
  <% end %>
</div>
